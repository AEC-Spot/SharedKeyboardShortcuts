<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Revit Keyboard Shortcuts Table</title>

<style>
    body { font-family: Arial; margin: 25px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 8px; }
    th { background: #eee; }
    tr.highlight { background-color: #ffeb3b; }
</style>
</head>
<body>

<h2>RevitKeyboard Shortcuts</h2>

<table id="shortcutsTable">
    <thead id="tableHead"></thead>
    <tbody id="tableBody"></tbody>
</table>

<script>
async function loadXML() {
    try {
        const response = await fetch("KeyboardShortcuts.xml");
        const text = await response.text();

        // Parse XML text into an XML document
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(text, "text/xml");

        const items = xmlDoc.getElementsByTagName("ShortcutItem");
        if (items.length === 0) return;

        const tableHead = document.getElementById("tableHead");
        const tableBody = document.getElementById("tableBody");

        // Get attribute names (columns) and exclude CommandId
        const attributeNames = Array.from(items[0].attributes)
            .map(a => a.name)
            .filter(name => name !== "CommandId");

        // Build header row
        tableHead.innerHTML = "<tr>" + 
            attributeNames.map(a => `<th>${a}</th>`).join("") +
            "</tr>";

            
        // Highlight specific CommandName values
        const highlightValues = [
        "BloomLT",
        "ElbowDown 45 LT",
        "ElbowDown LT",
        "ElbowUp LT",
        "DisconnectLT",
        "MoveConnect LT",
        "Align in3D LT",
        "AlignBranch LT",
        "SectionLT",
        "Mo-CoAlign LT",
        "Family Types",
        "Aligned Dimension",
        "Visibility/ Graphics",
        "Text",
        "3D View; Default 3D View",
        "Close Inactive Views",
        "Tab Views",
        "Tile Views",
        "Keyboard Shortcuts",
        "Align Left",
        "Align Center",
        "Align Right",
        "Align Top",
        "Align Middle",
        "Align Bottom",
        "Single Selection Mode:Match Bottom OffsetSingle Selection Mode",
        "Single Selection Mode:Match Middle OffsetSingle Selection Mode",
        "Single Selection Mode:Match Top OffsetSingle Selection Mode",
        "Match Type Properties",
        "Align",
        "Move",
        "Offset",
        "Copy",
        "Mirror - Pick Axis",
        "Rotate",
        "Mirror - Draw Axis",
        "Trim/Extend to Corner",
        "Split Element",
        "Trim/Extend Single Element",
        "Trim/Extend Multiple Elements",
        "Unpin",
        "Pin",
        "Create Similar",
        "Model Line",
        "Spot Elevation; Spot Elevation",
        "Detail Line",
        "Synchronize with Central:Synchronize Now",
        "Filters",
        "Hide in View:Hide Elements",
        "Hide in View:Hide Category",
        "Override Graphics in View:Override by Element",
        "Selection Box",
        "Cap Open Ends",
        "Toggle Reveal Hidden Elements Mode",
        "View Range",
        "Hide Category",
        "Reset Temporary Hide/Isolate",
        "Points",
        "Isolate Element",
        "Endpoints",
        "Hide Element",
        "Centers",
        "WireFrame",
        "Snap Off",
        "Consistent Colors",
        "Select All Instances: Visible in View",
        "Select Previous",
        "Fine Detail",
        "Coarse Detail",
        "Shaded with Edges",
    ];
        // Build table rows
        let rows = "";
        for (let item of items) {
            const commandName = item.getAttribute("CommandName") || "";
            const shouldHighlight = highlightValues.includes(commandName);
            rows += shouldHighlight ? "<tr class='highlight'>" : "<tr>";
            attributeNames.forEach(attr => {
                rows += `<td>${item.getAttribute(attr) || ""}</td>`;
            });
            rows += "</tr>";
        }
        tableBody.innerHTML = rows;

    } catch (error) {
        document.body.innerHTML += "<p style='color:red;'>Error loading XML file.</p>";
        console.error(error);
    }
}

loadXML();
</script>

</body>
</html>
