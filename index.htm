<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Revit Keyboard Shortcuts Table</title>

<style>
    body { font-family: Arial; margin: 25px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 8px; }
    th { background: #eee; }
    tr.highlight { background-color: #ffeb3b; }
</style>
</head>
<body>

<h2>RevitKeyboard Shortcuts</h2>

<table id="shortcutsTable">
    <thead id="tableHead"></thead>
    <tbody id="tableBody"></tbody>
</table>

<script>
async function loadXML() {
    try {
        const response = await fetch("KeyboardShortcuts.xml");
        const text = await response.text();

        // Parse XML text into an XML document
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(text, "text/xml");

        const items = xmlDoc.getElementsByTagName("ShortcutItem");
        if (items.length === 0) return;

        const tableHead = document.getElementById("tableHead");
        const tableBody = document.getElementById("tableBody");

        // Get attribute names (columns) and exclude CommandId
        const attributeNames = Array.from(items[0].attributes)
            .map(a => a.name)
            .filter(name => name !== "CommandId");

        // Build header row
        tableHead.innerHTML = "<tr>" + 
            attributeNames.map(a => `<th>${a}</th>`).join("") +
            "</tr>";

            
        // Highlight specific CommandName values
        const highlightValues = [
        "Background Processes", 
        "Options", 
        "Graphic Override by Element in View: toggle halftone"];
        // Build table rows
        let rows = "";
        for (let item of items) {
            const commandName = item.getAttribute("CommandName") || "";
            const shouldHighlight = highlightValues.includes(commandName);
            rows += shouldHighlight ? "<tr class='highlight'>" : "<tr>";
            attributeNames.forEach(attr => {
                rows += `<td>${item.getAttribute(attr) || ""}</td>`;
            });
            rows += "</tr>";
        }
        tableBody.innerHTML = rows;

    } catch (error) {
        document.body.innerHTML += "<p style='color:red;'>Error loading XML file.</p>";
        console.error(error);
    }
}

loadXML();
</script>

</body>
</html>
